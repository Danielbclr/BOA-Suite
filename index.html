<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>BOA</title>

    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css"/>
    
    <link href="vendor/material-kit/css/material-kit.css?v=2.0.5" rel="stylesheet"/>
    
    <link rel="stylesheet" href="vendor/jkanban/jkanban.min.css" />

    <link rel="stylesheet" href="vendor/bootstrap/css/bootstrap.min.css" />
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet"/>

    <link rel="stylesheet" href="css/styles.css" />

    <script src="./process.js"></script>
    <script src="./services.js"></script>
    <script src="./compose.js"></script>
    <script src="./search.js"></script>
    <script src="./boards.js"></script>
    <script src="./discover.js"></script>
    <script src="./server.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"> </script>
    <script src="https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/vkbeautify/vkbeautify.0.99.00.beta.js"></script>

    

    <style>
      body {
        font-family: "Lato";
        margin: 0;
        padding: 0;
      }

      #myKanban {
        overflow-x: auto;
        padding: 20px 0;
      }

      .success {
        background: #00b961;
      }

      .info {
        background: #2a92bf;
      }

      .warning {
        background: #f4ce46;
      }

      .error {
        background: #fb7d44;
      }
    </style>
  </head>
  <body>

      <nav class="navbar navbar-expand-lg bg-primary">
        <div class="container">
          <div class="navbar-translate">
            <a class="navbar-brand" href="#0">BOA</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" aria-expanded="false" aria-label="Toggle navigation">
              <span class="sr-only">Toggle navigation</span>
              <span class="navbar-toggler-icon"></span>
              <span class="navbar-toggler-icon"></span>
              <span class="navbar-toggler-icon"></span>
            </button>
          </div>
          <div class="collapse navbar-collapse">
            <ul class="navbar-nav ml-auto">
              <li class="active nav-item">
                <a href="#" class="nav-link">
                  <i class="material-icons">home</i> Home
                </a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    <div id="myKanban"></div>


  <!--  BOTAO DE ENVIO DO XPDL  -->
	<div class="input-group mb-3" style="display: none;">
	  <div class="input-group-prepend">
	    <span class="input-group-text" id="inputGroupFileAddon01">Upload</span>
	  </div>
	  <div class="custom-file" style="display: none;">
      <form id="xmlForm" name="xmlForm" enctype="multipart/form-data" onsubmit="return false">
          <input id="input" type="file" accept=".xpdl" name="file"> <input type="submit" id='arquivoOK'>
    	</form>
	  </div>
  </div>

  
<!-- TESTE
  <form method="post" action="/upload" enctype="multipart/form-data">
    <input type="file" name="file" />
    <input type="submit" />
  </form>
-->
  

<!--  CRIAR POP-UP PARA PUBLICACAO  -->
  <button class="open-button" onclick="openForm()">Open Form</button>

  <div class="form-popup" id="myForm">
    <form id='popupForm' class="form-container" onsubmit="return false">
      <h1>Publicação</h1>

      <p id='popupForm_p1'>Deseja publicar o seguinte .xpdl?</p>
      <p id="nome_xpdl"></p>

      <button type="button" class="btn" onclick="aceitarXpdl()">Aceitar</button>
      <button type="button" class="btn cancel" onclick="closeForm()">Cancelar</button>
    </form>
  </div>

  <div class="form-popup" id="myForm2">
    <form id='popupForm2' class="form-container">
      <h1>Publicação</h1>

      <p id='popupForm_p2'>Selecione as atividades que quer publicar</p>

      <button type="submit" class="btn" onclick="aceitarXpdl()">Aceitar</button>
      <button type="button" class="btn cancel" onclick="closeForm()">Cancelar</button>
    </form>
  </div>


  <!--
    <script>
	  const fileSelector = document.getElementById('file');
	  fileSelector.addEventListener('change', (event) => {
	    const fileList = event.target.files;
	    console.log(fileList);
	  });
	</script>
  -->
	

	<script>
    
    // var formDataFile = new FormData();
    // formDataFile.append('file', document.getElementById('input').files[0]);
    // var form = new FormData(document.getElementById('input').files[0]);
    //var fileUp = document.getElementById('input').files[0];

    //TENTATIVA USANDO AJAX
    //*
    function sendAjax( dataS){
      var formData = new FormData();
      formData.append('file', dataS);

      $.ajax({
          url: '/',
          data: formData,
          contentType: false,
          processData: false,
          type: 'POST',
          'success':function(data){
              alert(data);
          }
      });
    }
    //*/

    //*
    //TENTATIVA USANDO POST
    function sendPost( dataS){
      var form = req.form();
      form.append('file', dataS);

      const request = require('request');
      
      var req = request.post('/', function (err, resp, body) {
      if (err) {
        console.log('Error!');
      } else {
        console.log('URL: ' + body);
      }
    });
    
    }
       //*/
  //*
  //TENTATIVA USANDO FETCH
    function sendFetch( dataS){
      var formData = new FormData();
      formData.append('file', dataS);

      fetch('/',{
        method: "POST",
        body: dataS
      })
      .then(response => response.json())
      .then(data => {
        console.log(data.path)
      })
      .catch(error => {
        console.error(error)
      })
    }//*/
/*
       var readXml=null;
       $('#xmlForm').submit(function(event) {
        event.preventDefault();

        // $.get('/ajax', function(data, status){
        //   console.log(data);
        // })

        console.log("Imprimindo atividade");
        
        var selectedFile = document.getElementById('input').files[0];     

        console.log(selectedFile);
        var reader = new FileReader();
        reader.onload = function(e) {
            // console.log(e);
            // console.log(typeof e);

            // console.log(e.target);
            // console.log(typeof e.target);

            // console.log(e.target.result);
            // console.log(typeof e.target.result);

            readXml=e.target.result;
            console.log(readXml);

            sendAjax(selectedFile);

            var fileName = selectedFile.name.slice(0, -5);
            console.log(fileName)

            var parser = new DOMParser();
            var doc = parser.parseFromString(readXml, "application/xml");
            console.log(doc);
            console.log(typeof readXml);
            console.log(typeof doc);

            var nodes = doc.getElementsByTagName("Activity");
            console.log(nodes[0]);
            console.log(nodes[0].getAttribute("Id"));

      console.log(process.length + 1)
            var novoModelo=
            {
          header: {
              process_id: String(process.length + 1),
              name: fileName,
              description: "Diagrama 1",
              author: "Luciane Meconi",
          },
          steps:[]
      }

      var step = {
              id: "",
              name: "",
              boa: false
          };

          for( let i = 0; i < nodes.length; i++){
            var n = nodes[i];

            if(n.getAttribute("Name") != ""){
              step.id = n.getAttribute("Id");
              step.name = n.getAttribute("Name");

              console.log(i);
              console.log(step.id);
              console.log(step.name);

              novoModelo.steps.push({
                  id: n.getAttribute("Id"),
                  name: n.getAttribute("Name"),
                  boa: false
              }
              );

              console.log(novoModelo.steps[i]);
              console.log(novoModelo);
              console.log("================");
            }

          }

          console.log("Finalizou parse");

          console.log(novoModelo);
          console.log(process[0]);

          process.push(novoModelo);

          console.log(novoModelo);

            alert("Publicando processos");


          clearBoard();
          clearDiscover();

          populateWithProcesses();


        }
        reader.readAsText(selectedFile);

       });
*/
       

    </script>

    <script src="vendor/jkanban/jkanban.min.js"></script>
    
    <script>
      
      console.log(boards)
      var boards2 = boards;
      var KanbanTest = new jKanban({
        element: "#myKanban",
        widthBoard: '450px',
        responsivePercentage: true,  
        dragBoards: false,
        dragItems: false,

        click: function(el) {
          console.log("Trigger on all items click!");
          console.log(el);
          if(el.getAttribute('data-process_id') != null){
            console.log(el.getAttribute('data-process_id'));
            // console.log(getProcessById(el.getAttribute('data-process_id')));

            clearBoard();
            clearDiscover();

            populateWithProcesses();
            populateCompositionListWithProcess(getProcessById(el.getAttribute('data-process_id')), services);
            populateProcessListWithProcess(getProcessById(el.getAttribute('data-process_id')), services);
            decorateList();
            
          }
          if(el.getAttribute('data-wsdl') != null){
            console.log(el.getAttribute('data-wsdl'));

            

            var wsdlName = el.getAttribute('data-wsdl');

            $.get('/download/:'+el.getAttribute('data-wsdl'), function(data, status){
              
            })

            // $.post('/download/:' + wsdlName, function(data, status){
              
            // })

            // $.ajax({
            //     url: "/download/" + el.getAttribute('data-wsdl'),
            //     method: "get",
            //     success: function(){
            //         console.log('successful downloading');
            //     }
            // });
          }
          
        },
        buttonClick: function(el, boardId) {
          console.log(el);
          console.log(boardId);
          // create a form to enter element
          var formItem = document.createElement("form");
          formItem.setAttribute("class", "itemform");
          formItem.innerHTML =
            '<div class="form-group"><textarea class="form-control" rows="2" autofocus></textarea></div><div class="form-group"><button type="submit" class="btn btn-primary btn-xs pull-right">Submit</button><button type="button" id="CancelBtn" class="btn btn-default btn-xs pull-right">Cancel</button></div>';
          KanbanTest.addForm(boardId, formItem);
          formItem.addEventListener("submit", function(e) {
            e.preventDefault();
            var text = e.target[0].value;
            KanbanTest.addElement(boardId, {
              title: text
            });
            formItem.parentNode.removeChild(formItem);
          });
          document.getElementById("CancelBtn").onclick = function() {
            formItem.parentNode.removeChild(formItem);
          };
        },
        addItemButton: false,
        boards: [
        {
          id: "_publish",
          title: "Publicação",
          class: "error",
          dragTo: ["_working"],
          item: [
            {
              title: "<button style=\"text-align:center; margin: 0 auto;\" class=\"btn btn-primary btn-fab btn-round\"><i class=\"material-icons\">add</i> </button>Clique para adcionar um arquivo .xpdl",
              click: function(el) {
                getFile();
              // 	process.push(adcEl);

              // 	console.log(adcEl.header.name)

              // 	alert("Publicando processos");

              // 	console.log(process[4].header.name);

              // 	console.log(el.getAttribute('data-process_id'));
	            // console.log(getProcessById(el.getAttribute('data-process_id')));

	            // clearBoard();
	            // clearDiscover();

	            // populateWithProcesses();

              //   alert("Os processos foram publicados!");
              }
            }
          ]
        },
        {
          id: "_discover",
          title: "Descoberta <form style=\"text-align:center; margin: 10px;\" class=\"form ml-auto\"> <div class=\"form-group\"> <input id=\"searchForm\" type=\"text\" class=\"form-control\" onkeyup=\"search()\" placeholder=\"Procurar processo...\"> </div><button type=\"submit\" class=\"btn btn-white btn-raised btn-fab btn-round\"> <i class=\"material-icons\">search</i> </button> </form>",
          class: "warning",
        },
        {
          id: "_full_process",
          title: "Atividades do Processo",
          class: "success",
          dragTo: ["_working"],
          item: []
        },
        {
          id: "_compose",
          title: "Composição de Processos Publicos",
          class: "success",
          dragTo: ["_working"],
          item: []
        }
      ]
      });

      function closeForm() {
        document.getElementById("myForm").style.display = "none";
        document.getElementById('xmlForm').reset();
      }

      var ativ;
      var bpdl;
      var processElem;
      var atividades = [];

      var wsdls = [];
      var nomes = [];

      var serviços = [];

      var wsdl;

      var ul;

      var nomeP;
      var autorP;
      var versaoP;

      $('#xmlForm').submit(function(event) {
        //event.preventDefault();

        console.log("Submit!!!")

        bpdl = document.implementation.createDocument("", "", null);
        ativ = parseFile(document.getElementById('input').files[0]);
        processElem = bpdl.createElement("Processo");
        bpdl.appendChild(processElem); 

        console.log(ativ);
        //console.log(JSON.stringify(bpdl, null, 4));

      });

      function aceitarXpdl() {
        document.getElementById('arquivoOK').click();
        //document.getElementById('xmlForm').submit;

        //document.getElementById("myForm").style.display = "none";
        //document.getElementById("myForm2").style.display = "block";

        //document.getElementById('popupForm_p1').innerHTML = 'Selecione as atividades que quer publicar';
        document.getElementById('popupForm').innerHTML=
        '<h1>Publicação</h1>'+
        '<p>Insira as informações sobre o processo</p>'+
        '<label for="title"><b>Insira o nome do processo</b></label>' +
        '<input type="text" placeholder="Título" id="title" required>'+
        '<label for="author"><b>Insira o nome do autor</b></label>' +
        '<input type="text" placeholder="Autor" id="author" required>'+
        '<label for="version"><b>Insira a versão</b></label>' +
        '<input type="text" placeholder="Versão" id="version" required>'+
        '<label for="description"><b>Insira uma descrição</b></label>' +
        '<textarea id = "description"  placeholder="Insira uma descrição"></textarea>'+
        '<button type="submit" class="btn" onclick="aceitarHeader()">Seguinte</button>'+
        '<button type="button" class="btn cancel" onclick="closeForm()">Cancelar</button>';
      }

      function parseFile(selectedFile) {
        var readXml=null;

        console.log("Imprimindo atividade");

        console.log(selectedFile);

        var readerP = new FileReader();
        readerP.onload = function(e) {
          e.preventDefault();

          console.log("Imprimindo atividade");

          readXml=e.target.result;
          console.log(readXml);

          var parser = new DOMParser();
          var doc = parser.parseFromString(readXml, "application/xml");
          console.log(doc);
          console.log(typeof readXml);
          console.log(typeof doc);
          
          var nodes = doc.getElementsByTagName("Activity");
          console.log(nodes[0]);
          console.log(nodes[0].getAttribute("Id"));

          console.log(nodes);

          ativ = nodes;

          return nodes;
        }
      readerP.readAsText(selectedFile);
      }

      function addElement(e, ulParent, nomeAtiv){
        var fileN = document.createElement("input");
        var nomeN = document.createElement("input");
        fileN.type = "file";

        console.log(ulParent);

        serviços.push({
          wsdl:fileN,
          nome:nomeN,
          atividade:nomeAtiv
        })

        var item = document.createElement('li');
        item.appendChild(fileN);
        ulParent.appendChild(item);

        var item = document.createElement('li');
        item.appendChild(nomeN);
        ulParent.appendChild(item);
        
        fileN.onchange = addElement;

      }

      function addElementE(){
        var fileN = document.createElement("input");
        var nomeN = document.createElement("input");

        fileN.type = "file";
        fileN.name = this.name;

        ulParent = document.getElementById(this.name);

        serviços.push({
          wsdl:fileN,
          nome:nomeN,
          atividade:this.name
        })

        var item = document.createElement('li');
        item.appendChild(serviços[(serviços.length - 1)].wsdl);
        ulParent.appendChild(item);

        var item = document.createElement('li');
        item.appendChild(serviços[(serviços.length - 1)].nome);
        ulParent.appendChild(item);
        
        fileN.onchange = addElementE;

      }
      function aceitarWSDLs() {
        for( let i = 0; i < serviços.length; i++){
          if( serviços[i].nome.value != ""){
            // serviços.wsdl

            console.log( serviços[i].wsdl.files[0]);
            console.log( serviços[i].nome.value);
            console.log( serviços[i].atividade);

            wsdlElem = bpdl.createElement("Wsdl");
            wsdlElem.setAttribute("nome", serviços[i].nome.value);
            wsdlElem.innerHTML = serviços[i].wsdl.value.split(/(\\|\/)/g).pop();

            console.log('[nome="'+serviços[i].atividade+'"]');

            processElem.querySelector('[nome="'+serviços[i].atividade+'"]').appendChild(wsdlElem);

            var formData = new FormData();
            formData.append('file', serviços[i].wsdl.files[0]);

            $.ajax({
                url: '/',
                data: formData,
                contentType: false,
                processData: false,
                type: 'POST',
                'success':function(data){
                    alert(data);
                }
            });
          }
        }

        document.getElementById('popupForm').innerHTML=
          '<h1>Publicação</h1>'+
          '<p>Aguarde enquanto a Publicação finaliza</p>';

        finalizarPublicação();
      }

      function aceitarAtividadesPublicas(){

        var atividadesPublicas = document.querySelectorAll('input[type=checkbox]');
        var atividadesElem = bpdl.createElement("Atividades");

        document.getElementById('popupForm').innerHTML=
          '<h1>Publicação</h1>'+
          '<p>Selecione os wsdls que serão enviados</p>'+
          '<div id="lista-serviços">' +
          '</div>' +
          '<button type="submit" class="btn" onclick="aceitarWSDLs()">Seguinte</button>'+
          '<button type="button" class="btn cancel" onclick="closeForm()">Cancelar</button>';
          

        for (var i = 0; i < atividadesPublicas.length; i++) {
          console.log(atividadesPublicas[i].value + " " + atividadesPublicas[i].checked);
          if(atividadesPublicas[i].checked){
            console.log(atividades[i].name);
            atividades[i].public = true;

            var div = document.getElementById("lista-serviços");

            var para = document.createElement("p");
            var node = document.createTextNode(atividades[i].name);
            para.appendChild(node);

            div.appendChild(para);

            ul = document.createElement("ul");
            ul.setAttribute('id', atividades[i].name);
            ul.id = atividades[i].name;
            div.appendChild(ul);

            var wsdl = document.createElement("input");
            var nome = document.createElement("input");

            wsdl.type = "file";
            wsdl.name = atividades[i].name;
            // wsdls.push(wsdl);
            // nomes.push(nome);

            serviços.push({
              wsdl:wsdl,
              nome:nome,
              atividade: atividades[i].name
            })

            var item = document.createElement('li');
            item.appendChild(serviços[(serviços.length - 1)].wsdl);
            ul.appendChild(item);

            var item = document.createElement('li');
            item.appendChild(serviços[(serviços.length - 1)].nome);
            ul.appendChild(item);

            var nomeAtividade = atividades[i].name;

            // wsdl.onchange = function () {
            //   var nomeAtiv = nomeAtividade;
            //   var 
            //   addElement( wsdl, ul, nomeAtividade);
            // };

            wsdl.onchange = addElementE;
          }

          var ativElem = bpdl.createElement("Atividade");
          ativElem.setAttribute("nome", atividades[i].name);
          ativElem.setAttribute("id", atividades[i].id);
          ativElem.setAttribute("público", atividades[i].public);

          atividadesElem.appendChild(ativElem);

        }

        processElem.appendChild(atividadesElem);

        
      }

      function finalizarPublicação(){

        var XMLS = new XMLSerializer();
        var bpdl_xmls = XMLS.serializeToString(processElem);
        vkXML = vkbeautify.xml(bpdl_xmls);

        console.log(vkXML);
        console.log(typeof vkXML);

        //var blob = new Blob(vkXML, {type: 'plain/text'});
        var file = new File([vkXML], nomeP + "_V"+ versaoP+".bpdl", {type: "text/plain"});

        var formData = new FormData();
        formData.append('file', file);

        $.ajax({
            url: '/',
            data: formData,
            contentType: false,
            processData: false,
            type: 'POST',
            'success':function(data){
                alert(data);
            }
        });

        var formData = new FormData();
        formData.append('file', document.getElementById('input').files[0]);

        $.ajax({
            url: '/',
            data: formData,
            contentType: false,
            processData: false,
            type: 'POST',
            'success':function(data){
                alert(data);
            }
        });

        document.getElementById('popupForm').innerHTML=
          '<h1>Publicação Finalizada</h1>'+
          '<button type="submit" class="btn" onclick="refresh()">Finalizar</button>';

        }



      function refresh(){
        document.getElementById("myForm").style.display = "none";

        clearBoard();
        clearDiscover();

        populateWithProcesses();
      }

      function aceitarAtividades() {
        var checkboxes = document.querySelectorAll('input[type=checkbox]')

        document.getElementById('popupForm').innerHTML=
          '<h1>Publicação</h1>'+
          '<p>Selecione quais atividades são publicas</p>' +
          '<ul id="ul">'+
          '</ul>'+
          '<button type="submit" class="btn" onclick="aceitarAtividadesPublicas()">Seguinte</button>'+
          '<button type="button" class="btn cancel" onclick="closeForm()">Cancelar</button>';

        var list = document.getElementById('ul');
        var negados = [];

        for (var i = 0; i < checkboxes.length; i++) {
          console.log(checkboxes[i].value + " " + checkboxes[i].checked);
          if(checkboxes[i].checked) console.log(atividades[i].name);
          if(!checkboxes[i].checked) negados.push(i);
        }

        if(negados.length > 0){
          for (var i = 0; i < negados.length; i++) {
            atividades.splice(negados[i] - i,1);
          }
        }

        for( let i = 0; i < atividades.length; i++){
          var item = document.createElement('li');
          var checkBox = document.createElement("input");
          var label = document.createElement("label");

          checkBox.type = "checkbox";
          checkBox.value = atividades[i].name;

          item.appendChild(checkBox);
          item.appendChild(document.createTextNode("  "+atividades[i].name));
          list.appendChild(item);          
        }
      }

      const aceitarHeader = async () => {
        nomeP = document.getElementById('title').value;
        autorP = document.getElementById('author').value;
        versaoP = document.getElementById('version').value;
        var descriçãoP = document.getElementById('description').value;

        var currentdate = new Date(); 
        var datetime = currentdate.getDate() + "/"
                + (currentdate.getMonth()+1)  + "/" 
                + currentdate.getFullYear() + " @ "  
                + currentdate.getHours() + ":"  
                + currentdate.getMinutes() + ":" 
                + currentdate.getSeconds();

        if(nomeP != '' && autorP != ''){
          
          console.log(nomeP);
          console.log(autorP);
          console.log(versaoP);
          console.log(descriçãoP);

          var processInfoElem = bpdl.createElement("ProcessoInfo");

          var nomeElem = bpdl.createElement("Nome");
          nomeElem.innerHTML = nomeP;
          processInfoElem.appendChild(nomeElem);

          var autorElem = bpdl.createElement("Autor");
          autorElem.innerHTML = autorP;
          processInfoElem.appendChild(autorElem);

          var versaoElem = bpdl.createElement("Versão");
          versaoElem.innerHTML = versaoP;
          processInfoElem.appendChild(versaoElem);

          var dataElem = bpdl.createElement("Data");
          dataElem.innerHTML = datetime;
          processInfoElem.appendChild(dataElem);

          var descricaoElem = bpdl.createElement("Descrição");
          descricaoElem.innerHTML = descriçãoP;
          processInfoElem.appendChild(descricaoElem);

          processElem.appendChild(processInfoElem);

          console.log(bpdl.documentElement.innerHTML);

          console.log(ativ);

          //const ativ = await parseFile(document.getElementById('input').files[0]);

          console.log(ativ[0]);
          console.log(ativ[0].getAttribute("Id"));

          document.getElementById('popupForm').innerHTML=
          '<h1>Publicação</h1>'+
          '<p>Selecione as atividades que quer publicar</p>' +
          '<ul id="ul">'+
          '</ul>'+
          '<button type="submit" class="btn" onclick="aceitarAtividades()">Seguinte</button>'+
          '<button type="button" class="btn cancel" onclick="closeForm()">Cancelar</button>';

          var list = document.getElementById('ul');
          var popupForm = document.getElementById('popupForm');

          for( let i = 0; i < ativ.length; i++){
            var n = ativ[i];

            if(n.getAttribute("Name") != ""){
              ativId = n.getAttribute("Id");
              ativName = n.getAttribute("Name");

              console.log(i);
              console.log(ativId);
              console.log(ativName);

              atividades.push({
                  id: ativId,
                  name: ativName,
                  public: false
              });

              var item = document.createElement('li');
              var checkBox = document.createElement("input");
              var label = document.createElement("label");

              checkBox.type = "checkbox";
              checkBox.value = ativName;

              // popupForm.appendChild(checkBox);
              // popupForm.appendChild(label);
              // label.appendChild(document.createTextNode(ativName));

              item.appendChild(checkBox);
              item.appendChild(document.createTextNode("  "+ativName));
              list.appendChild(item);
              
              
            }
          }

        } 
      }

             


      function getFile(){
        document.getElementById('input').click();
        //document.getElementById("xmlForm").submit();
      }

      document.getElementById('input').onchange = function() {
        document.getElementById("nome_xpdl").innerHTML=document.getElementById('input').files[0].name;
        //alert(document.getElementById('input').files[0].name);
        document.getElementById("myForm").style.display = "block";
        
        //document.getElementById('input').submit();
      };

      var toDoButton = document.getElementById("addToDo");
      toDoButton.addEventListener("click", function() {
        KanbanTest.addElement("_todo", {
          title: "Test Add"
        });
      });

      var addBoardDefault = document.getElementById("addDefault");
      addBoardDefault.addEventListener("click", function() {
        KanbanTest.addBoards([
          {
            id: "_default",
            title: "Kanban Default",
            item: [
              {
                title: "Default Item"
              },
              {
                title: "Default Item 2"
              },
              {
                title: "Default Item 3"
              }
            ]
          }
        ]);
      });

    </script>
    <script>
    populateWithProcesses();
    decorateList();
    
    //var json = JSON.parse(process)
    console.log(process.header.name);
    console.log(document.querySelectorAll("[data-process]"));
    hideAll();



    
    var list = document.getElementById("myList");
    //list.removeChild(list.childNodes[0]);

    //console.log(process.getJSONObject("header").getString("author"))

    </script>



  </body>
</html>
